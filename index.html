<!doctype html>
<html lang='en'>
<head>
<meta charset='utf-8'>
<meta name='viewport' content='width=device-width,initial-scale=1' />
<title>Sound Engine</title>

<style>
:root{
  --bg:#0f172a;
  --btn:#ef4444;
  --btn2:#3b82f6;
  --fx:#10b981;
  --bar:#1e293b;
  --text:#fff;
}
html,body{
  height:100%;
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
  background:var(--bg);
  color:var(--text);
  overflow:hidden;
}
#tabs{
  width:100%;
  background:var(--bar);
  padding:12px;
  display:flex;
  gap:12px;
  border-radius:0 0 14px 14px;
}
.tab{
  padding:8px 16px;
  background:#334155;
  border-radius:8px;
  cursor:pointer;
  user-select:none;
}
.tab.active{
  background:#475569;
}
.screen{
  display:none;
  height:calc(100% - 70px);
  overflow:auto;
  padding:20px;
}
.screen.active{
  display:block;
}

/* Sounds and Effects buttons */
.sound-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(120px,1fr));
  gap:15px;
}
.btn{
  padding:16px;
  border-radius:12px;
  background:var(--btn2);
  text-align:center;
  font-weight:700;
  cursor:pointer;
  user-select:none;
}
.btn:active{
  filter:brightness(.85);
}

#effectBtn{
  padding:20px;
  border-radius:16px;
  background:var(--fx);
  width:160px;
  font-weight:800;
  text-align:center;
  margin-bottom:15px;
  cursor:pointer;
}

/* Music Maker */
#makerCanvas{
  position:relative;
  width:2000px;
  height:1400px;
  background:#1a2234;
  border-radius:16px;
  overflow:visible;
}

.node{
  position:absolute;
  width:130px;
  padding:12px;
  background:#3b82f6;
  border-radius:12px;
  text-align:center;
  cursor:grab;
  font-weight:700;
  user-select:none;
}
.node:active{cursor:grabbing;}

.line{
  position:absolute;
  height:4px;
  background:#22d3ee;
  transform-origin:0 0;
  border-radius:4px;
}

</style>
</head>
<body>

<!-- Tabs -->
<div id='tabs'>
  <div class='tab active' data-tab='sounds'>Sounds</div>
  <div class='tab' data-tab='effects'>Effects</div>
  <div class='tab' data-tab='maker'>Music Maker</div>
</div>

<!-- Screens -->
<div id='sounds' class='screen active'>
  <div class='sound-grid' id='soundGrid'></div>
</div>

<div id='effects' class='screen'>
  <div id='effectBtn'>Censor</div>
</div>

<div id='maker' class='screen'>
  <div id='makerCanvas'></div>
</div>

<audio id='curseAudio' src='curse_beep.mp3' preload='auto'></audio>

<script>

const audioCtx = new (window.AudioContext||window.webkitAudioContext)();
let playing={};

/* Tab Switching */
document.querySelectorAll('.tab').forEach(t=>{
  t.addEventListener('click',()=>{
    document.querySelectorAll('.tab').forEach(a=>a.classList.remove('active'));
    t.classList.add('active');
    document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
    document.getElementById(t.dataset.tab).classList.add('active');
  });
});

/* Sound List */
const soundNames=[
  'Ping','Pong','Zap','Laser','Boop','Whistle','Chirp','Deep',
  'Tone','Sweep','Error','Ping High','Click','Spark','Short Beep','Low Buzz'
];

function playOsc(start,end,type,dur){
  const now=audioCtx.currentTime;
  const g=audioCtx.createGain();
  g.gain.setValueAtTime(.001,now);
  g.gain.exponentialRampToValueAtTime(1,now+.01);
  g.gain.exponentialRampToValueAtTime(.001,now+dur);
  g.connect(audioCtx.destination);

  const o=audioCtx.createOscillator();
  o.frequency.setValueAtTime(start,now);
  o.frequency.exponentialRampToValueAtTime(end,now+dur);
  o.type=type;
  o.connect(g);
  o.start(now);
  o.stop(now+dur);
}

function playSoundID(id){
  switch(id){
    case 1: playOsc(800,800,'sine',.2); break;
    case 2: playOsc(600,600,'sine',.2); break;
    case 3: playOsc(400,800,'square',.25); break;
    case 4: playOsc(1500,2000,'sawtooth',.3); break;
    case 5: playOsc(900,600,'square',.15); break;
    case 6: playOsc(1500,2500,'sine',.5); break;
    case 7: playOsc(2000,2400,'triangle',.2); break;
    case 8: playOsc(200,200,'sine',.4); break;
    case 9: playOsc(500,500,'square',.3); break;
    case 10: playOsc(700,1200,'sine',.35); break;
    case 11: playOsc(300,300,'square',.25); break;
    case 12: playOsc(2000,2600,'sine',.2); break;
    case 13: playOsc(900,900,'triangle',.1); break;
    case 14: playOsc(2500,800,'sawtooth',.25); break;
    case 15: playOsc(700,700,'sine',.15); break;
    case 16: playOsc(150,150,'square',.5); break;
  }
}

/* Build Sound Buttons */
const grid=document.getElementById('soundGrid');
soundNames.forEach((n,i)=>{
  const b=document.createElement('div');
  b.className='btn';
  b.textContent=n;
  b.addEventListener('mousedown',()=>playSoundID(i+1));
  b.addEventListener('touchstart',e=>{e.preventDefault();playSoundID(i+1);},{passive:false});
  grid.appendChild(b);
});

/* EFFECTS â€” CENSOR */
document.getElementById('effectBtn').addEventListener('click',()=>{
  const a=document.getElementById('curseAudio');
  a.currentTime=0;
  a.play();
});

/* MUSIC MAKER SYSTEM */
const canvas=document.getElementById('makerCanvas');
let currentLine=null;
let nodeList=[];
let linkList=[];

function makeNode(x,y,label){
  const d=document.createElement('div');
  d.className='node';
  d.textContent=label;
  d.style.left=x+'px';
  d.style.top=y+'px';
  canvas.appendChild(d);

  let offX,offY,drag=false;

  d.addEventListener('mousedown',e=>{
    drag=true;
    offX=e.offsetX;
    offY=e.offsetY;
  });
  document.addEventListener('mouseup',()=>drag=false);
  document.addEventListener('mousemove',e=>{
    if(!drag)return;
    d.style.left=(e.pageX-offX)+'px';
    d.style.top=(e.pageY-offY)+'px';
  });

  /* Node linking */
  d.addEventListener('mousedown',e=>{
    currentLine={
      from:d,
      x1:e.pageX,
      y1:e.pageY
    };
  });

  document.addEventListener('mouseup',e=>{
    if(!currentLine)return;
    const target=e.target;
    if(target.classList.contains('node') && target!==currentLine.from){
      makeLink(currentLine.from,target);
    }
    currentLine=null;
  });

  nodeList.push(d);
}

function makeLink(n1,n2){
  const L=document.createElement('div');
  L.className='line';
  canvas.appendChild(L);
  linkList.push({n1,n2,L});
  updateLine(n1,n2,L);

  /* Play chain when clicking n1 */
  n1.addEventListener('click',()=>{
    const idx=soundNames.indexOf(n1.textContent);
    if(idx>=0) playSoundID(idx+1);
    playChain(n1);
  });
}

function updateLine(n1,n2,L){
  const x1=n1.offsetLeft+65;
  const y1=n1.offsetTop+25;
  const x2=n2.offsetLeft+65;
  const y2=n2.offsetTop+25;
  const dx=x2-x1;
  const dy=y2-y1;
  const len=Math.sqrt(dx*dx+dy*dy);
  const ang=Math.atan2(dy,dx)*180/Math.PI;

  L.style.left=x1+'px';
  L.style.top=y1+'px';
  L.style.width=len+'px';
  L.style.transform='rotate('+ang+'deg)';
}

function playChain(start){
  const con=linkList.filter(l=>l.n1===start);
  con.forEach(l=>{
    const next=l.n2;
    const idx=soundNames.indexOf(next.textContent);
    if(idx>=0) playSoundID(idx+1);
    setTimeout(()=>playChain(next),200);
  });
}

/* Auto update link positions on drag */
setInterval(()=>{
  linkList.forEach(o=>updateLine(o.n1,o.n2,o.L));
},50);

/* Pre-place some nodes */
makeNode(200,200,'Ping');
makeNode(500,240,'Zap');
makeNode(800,180,'Laser');

</script>
</body>
</html>
